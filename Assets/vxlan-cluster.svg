<svg viewBox="0 0 1400 1000" xmlns="http://www.w3.org/2000/svg">
  <!-- Background gradient -->
  <defs>
    <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f8f9fa;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#e9ecef;stop-opacity:1" />
    </linearGradient>
    
    <!-- Shadow filter -->
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="3" dy="3" stdDeviation="3" flood-color="#000" flood-opacity="0.2"/>
    </filter>
    
    <!-- Glow effect -->
    <filter id="glow">
      <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
      <feMerge> 
        <feMergeNode in="coloredBlur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
    
    <!-- Arrow markers -->
    <marker id="arrowBlue" markerWidth="12" markerHeight="8" refX="11" refY="4" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,8 L12,4 z" fill="#3498db"/>
    </marker>
    
    <marker id="arrowPurple" markerWidth="12" markerHeight="8" refX="11" refY="4" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,8 L12,4 z" fill="#9b59b6"/>
    </marker>
    
    <marker id="arrowGreen" markerWidth="12" markerHeight="8" refX="11" refY="4" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,8 L12,4 z" fill="#27ae60"/>
    </marker>
  </defs>
  
  <rect width="1400" height="1000" fill="url(#bgGradient)"/>
  
  <!-- Main Title -->
  <text x="700" y="40" text-anchor="middle" font-size="28" font-weight="bold" fill="#2c3e50" filter="url(#glow)">
    VXLAN Container Cluster Architecture
  </text>
  <text x="700" y="65" text-anchor="middle" font-size="14" fill="#7f8c8d">
    Multi-Host Container Orchestration with Centralized IP Management
  </text>
  
  <!-- Management Network Background -->
  <rect x="50" y="90" width="1300" height="100" fill="#e3f2fd" stroke="#2196f3" stroke-width="3" rx="15" filter="url(#shadow)"/>
  <text x="700" y="125" text-anchor="middle" font-size="18" font-weight="bold" fill="#1565c0">
    🌐 Management Network (10.0.1.0/24)
  </text>
  <text x="700" y="150" text-anchor="middle" font-size="12" fill="#1976d2">
    Physical Network Infrastructure - API Communication &amp; Management
  </text>
  <text x="700" y="170" text-anchor="middle" font-size="11" fill="#424242">
    SSH Access • HTTP API Calls • Service Discovery • Health Monitoring
  </text>
  
  <!-- Container Network Overlay -->
  <rect x="50" y="780" width="1300" height="100" fill="#f3e5f5" stroke="#9c27b0" stroke-width="3" rx="15" filter="url(#shadow)"/>
  <text x="700" y="815" text-anchor="middle" font-size="18" font-weight="bold" fill="#7b1fa2">
    🔗 Container Overlay Network (172.20.0.0/16)
  </text>
  <text x="700" y="840" text-anchor="middle" font-size="12" fill="#8e24aa">
    VXLAN Tunnel Network - Container-to-Container Communication
  </text>
  <text x="700" y="860" text-anchor="middle" font-size="11" fill="#424242">
    VNI: 100 • UDP Port: 4789 • Gateway: 172.20.0.1 • Range: 172.20.0.10 - 172.20.255.254
  </text>
  
  <!-- HOST 1 - Container Node -->
  <g id="host1" filter="url(#shadow)">
    <!-- Main host container -->
    <rect x="80" y="220" width="350" height="520" fill="#ffffff" stroke="#34495e" stroke-width="3" rx="20"/>
    
    <!-- Host header -->
    <rect x="90" y="230" width="330" height="60" fill="#e74c3c" rx="15"/>
    <text x="255" y="255" text-anchor="middle" font-size="16" font-weight="bold" fill="white">
      🖥️ HOST 1 - Container Node
    </text>
    <text x="255" y="275" text-anchor="middle" font-size="12" fill="white">
      Primary Container Host • IP: 10.0.1.142
    </text>
    
    <!-- Management IP indicator -->
    <!-- <circle cx="255" cy="140" r="12" fill="#e74c3c" stroke="#c0392b" stroke-width="2"/>
    <text x="255" y="165" text-anchor="middle" font-size="11" font-weight="bold" fill="#2c3e50">10.0.1.142</text> -->
    
    <!-- Container Service -->
    <rect x="100" y="310" width="310" height="70" fill="#3498db" stroke="#2980b9" stroke-width="2" rx="10"/>
    <text x="255" y="335" text-anchor="middle" font-size="14" font-weight="bold" fill="white">
      📦 Container Service
    </text>
    <text x="255" y="355" text-anchor="middle" font-size="11" fill="white">
      FastAPI • Port 8001 • Docker Management
    </text>
    <text x="255" y="370" text-anchor="middle" font-size="10" fill="#ecf0f1">
      Container Creation • IP Assignment • Lifecycle Management
    </text>
    
    <!-- Docker Engine -->
    <rect x="100" y="390" width="310" height="50" fill="#2ecc71" stroke="#27ae60" stroke-width="2" rx="10"/>
    <text x="255" y="415" text-anchor="middle" font-size="14" font-weight="bold" fill="white">
      🐳 Docker Engine
    </text>
    <text x="255" y="430" text-anchor="middle" font-size="11" fill="white">
      Container Runtime • Network Management
    </text>
    
    <!-- VXLAN Interface -->
    <rect x="100" y="450" width="310" height="50" fill="#9b59b6" stroke="#8e44ad" stroke-width="2" rx="10"/>
    <text x="255" y="475" text-anchor="middle" font-size="14" font-weight="bold" fill="white">
      🌐 VXLAN Interface (vxlan0)
    </text>
    <text x="255" y="490" text-anchor="middle" font-size="11" fill="white">
      VNI: 100 • Remote: 10.0.1.6 • Port: 4789
    </text>
    
    <!-- Docker Network -->
    <rect x="100" y="510" width="310" height="40" fill="#f39c12" stroke="#e67e22" stroke-width="2" rx="10"/>
    <text x="255" y="535" text-anchor="middle" font-size="12" font-weight="bold" fill="white">
      🔗 Docker Bridge Network (vxlan-net)
    </text>
    
    <!-- Running Containers -->
    <text x="255" y="575" text-anchor="middle" font-size="13" font-weight="bold" fill="#2c3e50">
      Running Containers
    </text>
    
    <rect x="110" y="585" width="90" height="70" fill="#1abc9c" stroke="#16a085" stroke-width="2" rx="8"/>
    <text x="155" y="605" text-anchor="middle" font-size="11" font-weight="bold" fill="white">nginx1</text>
    <text x="155" y="620" text-anchor="middle" font-size="9" fill="white">172.20.0.10</text>
    <text x="155" y="635" text-anchor="middle" font-size="8" fill="white">nginx:alpine</text>
    <text x="155" y="650" text-anchor="middle" font-size="8" fill="white">Port: 80</text>
    
    <rect x="210" y="585" width="90" height="70" fill="#1abc9c" stroke="#16a085" stroke-width="2" rx="8"/>
    <text x="255" y="605" text-anchor="middle" font-size="11" font-weight="bold" fill="white">web1</text>
    <text x="255" y="620" text-anchor="middle" font-size="9" fill="white">172.20.0.11</text>
    <text x="255" y="635" text-anchor="middle" font-size="8" fill="white">httpd:latest</text>
    <text x="255" y="650" text-anchor="middle" font-size="8" fill="white">Port: 80</text>
    
    <rect x="310" y="585" width="90" height="70" fill="#1abc9c" stroke="#16a085" stroke-width="2" rx="8"/>
    <text x="355" y="605" text-anchor="middle" font-size="11" font-weight="bold" fill="white">app1</text>
    <text x="355" y="620" text-anchor="middle" font-size="9" fill="white">172.20.0.12</text>
    <text x="355" y="635" text-anchor="middle" font-size="8" fill="white">node:18</text>
    <text x="355" y="650" text-anchor="middle" font-size="8" fill="white">Port: 3000</text>
    
    <!-- Stats -->
    <rect x="110" y="665" width="290" height="60" fill="#ecf0f1" stroke="#bdc3c7" stroke-width="1" rx="8"/>
    <text x="255" y="685" text-anchor="middle" font-size="11" font-weight="bold" fill="#2c3e50">
      📊 Host Statistics
    </text>
    <text x="255" y="700" text-anchor="middle" font-size="10" fill="#2c3e50">
      Active Containers: 3 • CPU: 45% • Memory: 2.1GB/8GB
    </text>
    <text x="255" y="715" text-anchor="middle" font-size="10" fill="#2c3e50">
      Network: Active • VXLAN: Connected • Docker: Running
    </text>
  </g>
  
  <!-- HOST 2 - Container Node -->
  <g id="host2" filter="url(#shadow)">
    <!-- Main host container -->
    <rect x="480" y="220" width="350" height="520" fill="#ffffff" stroke="#34495e" stroke-width="3" rx="20"/>
    
    <!-- Host header -->
    <rect x="490" y="230" width="330" height="60" fill="#e74c3c" rx="15"/>
    <text x="655" y="255" text-anchor="middle" font-size="16" font-weight="bold" fill="white">
      🖥️ HOST 2 - Container Node
    </text>
    <text x="655" y="275" text-anchor="middle" font-size="12" fill="white">
      Secondary Container Host • IP: 10.0.1.6
    </text>
    
    <!-- Management IP indicator -->
    <!-- <circle cx="655" cy="140" r="12" fill="#e74c3c" stroke="#c0392b" stroke-width="2"/>
    <text x="655" y="165" text-anchor="middle" font-size="11" font-weight="bold" fill="#2c3e50">10.0.1.6</text> -->
    
    <!-- Container Service -->
    <rect x="500" y="310" width="310" height="70" fill="#3498db" stroke="#2980b9" stroke-width="2" rx="10"/>
    <text x="655" y="335" text-anchor="middle" font-size="14" font-weight="bold" fill="white">
      📦 Container Service
    </text>
    <text x="655" y="355" text-anchor="middle" font-size="11" fill="white">
      FastAPI • Port 8001 • Docker Management
    </text>
    <text x="655" y="370" text-anchor="middle" font-size="10" fill="#ecf0f1">
      Container Creation • IP Assignment • Lifecycle Management
    </text>
    
    <!-- Docker Engine -->
    <rect x="500" y="390" width="310" height="50" fill="#2ecc71" stroke="#27ae60" stroke-width="2" rx="10"/>
    <text x="655" y="415" text-anchor="middle" font-size="14" font-weight="bold" fill="white">
      🐳 Docker Engine
    </text>
    <text x="655" y="430" text-anchor="middle" font-size="11" fill="white">
      Container Runtime • Network Management
    </text>
    
    <!-- VXLAN Interface -->
    <rect x="500" y="450" width="310" height="50" fill="#9b59b6" stroke="#8e44ad" stroke-width="2" rx="10"/>
    <text x="655" y="475" text-anchor="middle" font-size="14" font-weight="bold" fill="white">
      🌐 VXLAN Interface (vxlan0)
    </text>
    <text x="655" y="490" text-anchor="middle" font-size="11" fill="white">
      VNI: 100 • Remote: 10.0.1.142 • Port: 4789
    </text>
    
    <!-- Docker Network -->
    <rect x="500" y="510" width="310" height="40" fill="#f39c12" stroke="#e67e22" stroke-width="2" rx="10"/>
    <text x="655" y="535" text-anchor="middle" font-size="12" font-weight="bold" fill="white">
      🔗 Docker Bridge Network (vxlan-net)
    </text>
    
    <!-- Running Containers -->
    <text x="655" y="575" text-anchor="middle" font-size="13" font-weight="bold" fill="#2c3e50">
      Running Containers
    </text>
    
    <rect x="510" y="585" width="90" height="70" fill="#1abc9c" stroke="#16a085" stroke-width="2" rx="8"/>
    <text x="555" y="605" text-anchor="middle" font-size="11" font-weight="bold" fill="white">nginx2</text>
    <text x="555" y="620" text-anchor="middle" font-size="9" fill="white">172.20.0.13</text>
    <text x="555" y="635" text-anchor="middle" font-size="8" fill="white">nginx:alpine</text>
    <text x="555" y="650" text-anchor="middle" font-size="8" fill="white">Port: 80</text>
    
    <rect x="610" y="585" width="90" height="70" fill="#1abc9c" stroke="#16a085" stroke-width="2" rx="8"/>
    <text x="655" y="605" text-anchor="middle" font-size="11" font-weight="bold" fill="white">db1</text>
    <text x="655" y="620" text-anchor="middle" font-size="9" fill="white">172.20.0.14</text>
    <text x="655" y="635" text-anchor="middle" font-size="8" fill="white">postgres:14</text>
    <text x="655" y="650" text-anchor="middle" font-size="8" fill="white">Port: 5432</text>
    
    <rect x="710" y="585" width="90" height="70" fill="#1abc9c" stroke="#16a085" stroke-width="2" rx="8"/>
    <text x="755" y="605" text-anchor="middle" font-size="11" font-weight="bold" fill="white">api1</text>
    <text x="755" y="620" text-anchor="middle" font-size="9" fill="white">172.20.0.15</text>
    <text x="755" y="635" text-anchor="middle" font-size="8" fill="white">python:3.11</text>
    <text x="755" y="650" text-anchor="middle" font-size="8" fill="white">Port: 8080</text>
    
    <!-- Stats -->
    <rect x="510" y="665" width="290" height="60" fill="#ecf0f1" stroke="#bdc3c7" stroke-width="1" rx="8"/>
    <text x="655" y="685" text-anchor="middle" font-size="11" font-weight="bold" fill="#2c3e50">
      📊 Host Statistics
    </text>
    <text x="655" y="700" text-anchor="middle" font-size="10" fill="#2c3e50">
      Active Containers: 3 • CPU: 32% • Memory: 1.8GB/8GB
    </text>
    <text x="655" y="715" text-anchor="middle" font-size="10" fill="#2c3e50">
      Network: Active • VXLAN: Connected • Docker: Running
    </text>
  </g>
  
  <!-- HOST 3 - IPAM Node -->
  <g id="host3" filter="url(#shadow)">
    <!-- Main host container -->
    <rect x="880" y="220" width="420" height="520" fill="#ffffff" stroke="#34495e" stroke-width="3" rx="20"/>
    
    <!-- Host header -->
    <rect x="890" y="230" width="400" height="60" fill="#16a085" rx="15"/>
    <text x="1090" y="255" text-anchor="middle" font-size="16" font-weight="bold" fill="white">
      🎯 HOST 3 - IPAM Control Node
    </text>
    <text x="1090" y="275" text-anchor="middle" font-size="12" fill="white">
      Centralized IP Address Management • IP: 10.0.1.100
    </text>
    
    <!-- Management IP indicator -->
    <!-- <circle cx="1090" cy="140" r="12" fill="#16a085" stroke="#138d75" stroke-width="2"/>
    <text x="1090" y="165" text-anchor="middle" font-size="11" font-weight="bold" fill="#2c3e50">10.0.1.100</text> -->
    
    <!-- IPAM Service -->
    <rect x="900" y="310" width="380" height="80" fill="#e67e22" stroke="#d35400" stroke-width="2" rx="10"/>
    <text x="1090" y="340" text-anchor="middle" font-size="16" font-weight="bold" fill="white">
      🧠 IPAM Service
    </text>
    <text x="1090" y="360" text-anchor="middle" font-size="12" fill="white">
      FastAPI • Port 8000 • IP Address Management
    </text>
    <text x="1090" y="375" text-anchor="middle" font-size="10" fill="#ecf0f1">
      Allocation • Deallocation • Global Registry • Health Monitoring
    </text>
    
    <!-- Redis Database -->
    <rect x="900" y="400" width="380" height="80" fill="#c0392b" stroke="#a93226" stroke-width="2" rx="10"/>
    <text x="1090" y="430" text-anchor="middle" font-size="16" font-weight="bold" fill="white">
      💾 Redis Database
    </text>
    <text x="1090" y="450" text-anchor="middle" font-size="12" fill="white">
      In-Memory Database • Port 6379 • Persistent Storage
    </text>
    <text x="1090" y="465" text-anchor="middle" font-size="10" fill="#ecf0f1">
      IP Pool Management • Container Registry • Host Mapping
    </text>
    
    <!-- Redis Data Structures -->
    <rect x="900" y="490" width="380" height="140" fill="#ecf0f1" stroke="#bdc3c7" stroke-width="2" rx="10"/>
    <text x="1090" y="515" text-anchor="middle" font-size="14" font-weight="bold" fill="#2c3e50">
      📋 Redis Data Structures
    </text>
    
    <text x="920" y="540" font-size="11" font-weight="bold" fill="#c0392b">Sets (IP Pools):</text>
    <text x="920" y="555" font-size="10" fill="#2c3e50">• available_ips: {172.20.0.16, 172.20.0.17, 172.20.0.18, ...}</text>
    <text x="920" y="570" font-size="10" fill="#2c3e50">• allocated_ips: {172.20.0.10, 172.20.0.11, 172.20.0.12, ...}</text>
    
    <text x="920" y="590" font-size="11" font-weight="bold" fill="#e67e22">Hashes (Mappings):</text>
    <text x="920" y="605" font-size="10" fill="#2c3e50">• container_ips: nginx1→172.20.0.10, web1→172.20.0.11</text>
    <text x="920" y="620" font-size="10" fill="#2c3e50">• container_hosts: nginx1→10.0.1.142, nginx2→10.0.1.6</text>
    
    <!-- Statistics Panel -->
    <rect x="900" y="640" width="380" height="85" fill="#f8f9fa" stroke="#dee2e6" stroke-width="2" rx="10"/>
    <text x="1090" y="665" text-anchor="middle" font-size="14" font-weight="bold" fill="#2c3e50">
      📈 IPAM Statistics
    </text>
    <text x="1090" y="685" text-anchor="middle" font-size="12" fill="#2c3e50">
      Total IPs: 65,534 • Available: 65,528 • Allocated: 6
    </text>
    <text x="1090" y="700" text-anchor="middle" font-size="11" fill="#2c3e50">
      Active Containers: 6 • Active Hosts: 2 • Pool Utilization: 0.01%
    </text>
    <text x="1090" y="715" text-anchor="middle" font-size="10" fill="#7f8c8d">
      Last Allocation: nginx2 (172.20.0.13) • Uptime: 99.9%
    </text>
  </g>
  
  <!-- VXLAN Tunnel Connection -->
  <path d="M 430 475 Q 525 400 520 475" stroke="#9b59b6" stroke-width="8" fill="none" stroke-dasharray="20,10" filter="url(#glow)"/>
  <rect x="420" y="395" width="140" height="50" fill="#9b59b6" rx="25"/>
  <text x="490" y="415" text-anchor="middle" font-size="12" font-weight="bold" fill="white">
    🌉 VXLAN Tunnel
  </text>
  <text x="490" y="430" text-anchor="middle" font-size="10" fill="white">
    UDP:4789 • VNI:100
  </text>
  
  <!-- API Communication Lines -->
  <!-- Host 1 to IPAM -->
  <path d="M 430 345 Q 650 280 880 345" stroke="#3498db" stroke-width="4" fill="none" marker-end="url(#arrowBlue)"/>
  <text x="655" y="300" text-anchor="middle" font-size="11" font-weight="bold" fill="#2980b9">
    HTTP API
  </text>
  
  <!-- Host 2 to IPAM -->
  <path d="M 830 345 Q 855 340 880 345" stroke="#3498db" stroke-width="4" fill="none" marker-end="url(#arrowBlue)"/>
  
  <!-- Container Communication Examples -->
  <path d="M 155 655 Q 300 730 555 655" stroke="#27ae60" stroke-width="3" fill="none" marker-end="url(#arrowGreen)" stroke-dasharray="10,5"/>
  <text x="355" y="720" text-anchor="middle" font-size="10" font-weight="bold" fill="#27ae60">
    Container Communication via VXLAN
  </text>
  
  <!-- Legend -->
  <g id="legend" filter="url(#shadow)">
    <rect x="50" y="920" width="1300" height="60" fill="#ffffff" stroke="#95a5a6" stroke-width="2" rx="10"/>
    <text x="700" y="945" text-anchor="middle" font-size="16" font-weight="bold" fill="#2c3e50">
      🔗 Architecture Legend
    </text>
    
    <!-- Legend items in a single row -->
    <rect x="80" y="955" width="15" height="10" fill="#3498db"/>
    <text x="105" y="964" font-size="10" fill="#2c3e50">Container Service</text>
    
    <rect x="220" y="955" width="15" height="10" fill="#e67e22"/>
    <text x="245" y="964" font-size="10" fill="#2c3e50">IPAM Service</text>
    
    <rect x="340" y="955" width="15" height="10" fill="#c0392b"/>
    <text x="365" y="964" font-size="10" fill="#2c3e50">Redis Database</text>
    
    <rect x="460" y="955" width="15" height="10" fill="#1abc9c"/>
    <text x="485" y="964" font-size="10" fill="#2c3e50">Containers</text>
    
    <rect x="570" y="955" width="15" height="10" fill="#9b59b6"/>
    <text x="595" y="964" font-size="10" fill="#2c3e50">VXLAN Network</text>
    
    <line x1="690" y1="960" x2="720" y2="960" stroke="#3498db" stroke-width="3"/>
    <text x="730" y="964" font-size="10" fill="#2c3e50">HTTP API</text>
    
    <line x1="810" y1="960" x2="840" y2="960" stroke="#27ae60" stroke-width="3" stroke-dasharray="5,3"/>
    <text x="850" y="964" font-size="10" fill="#2c3e50">Container Traffic</text>
    
    <text x="1000" y="960" font-size="10" fill="#7f8c8d">Network Ports:</text>
    <text x="1100" y="960" font-size="10" fill="#7f8c8d">8000 (IPAM)</text>
    <text x="1170" y="960" font-size="10" fill="#7f8c8d">8001 (Container)</text>
    <text x="1270" y="960" font-size="10" fill="#7f8c8d">4789 (VXLAN)</text>
  </g>
</svg>